this is a copy of the old master code that MOSTLY worked as of a year ago.
